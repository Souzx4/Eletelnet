<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="estilos/styles.css">
    <link rel="stylesheet" href="estilos/mobile.css" media="screen and (max-width: 580px)">
    <title>Eletelnet</title>
</head>
<body>
    <header>
        <img src="estilos/logo.png" alt="Logo Eletelnet" style="display: block; margin: auto; padding-top: 10px; width: 210px;">
        <h1>Documentação Eletelnet</h1>
        <p>Seja bem vindo colaborador! Um site criado para você tirar suas duvidas e lhe ajudar nos problemas do dia a dia e melhorias que podemos está sempre inovando em busca da excelência.</p>
    </header>
    <section>
        <h2 id="principal">Departamentos:</h2>
        <ul id="listaLinks">
            <li data-permissao="suporte"><a href="suporte/suporteTec.html"><strong>Suporte</strong></a></li>
            <li data-permissao="atendimento"><a href="atendimento/atendimento.html"><strong>Atendimento</strong></a></li>
            <li data-permissao="financeiro"><a href="financeiro/financeiro.html"><strong>Financeiro</strong></a></li>
            <li data-permissao="estoque"><a href="estoque/estoque.html"><strong>Estoque</strong></a></li>
            <li data-permissao="feedback"><a href="feedback/feedback.html"><strong>Feedback</strong></a></li>
            <li data-permissao="marketing"><a href="marketing/marketing.html"><strong>Marketing</strong></a></li>
            <li data-permissao="cobranca"><a href="cobranca/cobranca.html"><strong>Cobrança</strong></a></li>
            <li data-permissao="noc"><a href="NOC/noc.html"><strong>NOC</strong></a></li>
            <li data-permissao="operacao"><a href="OperacaoCampo/operacaoCampo.html"><strong>Operação de Campo</strong></a></li>
            <li data-permissao="construcao"><a href="ConstrucaoRede/construcaoRedes.html"><strong>Construção de Redes</strong></a></li>
            <li data-permissao="comercial"><a href="comecialVendas/comercialVendas.html"><strong>Comercial e Vendas</strong></a></li>
            <li data-permissao="executiva"><a href="gestaoExecutiva/gestaoExecutiva.html"><strong>Gestão Executiva</strong></a></li>
            <li data-permissao="limpeza"><a href="limpeza/limpeza.html"><strong>Limpeza</strong></a></li>
            <li data-permissao="filiais"><a href="filiais/filiais.html"><strong>Filiais</strong></a></li>
        </ul>
    </section>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const emailLogado = localStorage.getItem('usuarioLogado');
        
        if (!emailLogado) {
            window.location.href = 'login/login.html';
            return;
        }

        const rawDepto = localStorage.getItem(`depto_${emailLogado}`) || "";
        const meusDepartamentos = rawDepto.split(','); 

        const todosItens = document.querySelectorAll('#listaLinks li');
        
        // --- NOVIDADE AQUI: Variáveis para contar ---
        let linksVisiveis = 0;
        let ultimoLinkEncontrado = "";

        todosItens.forEach(item => {
            const permissaoNecessaria = item.getAttribute('data-permissao');
            let mostrar = false;

            // Lógica de verificação
            if (meusDepartamentos.includes('admin')) {
                mostrar = true;
            } else if (meusDepartamentos.includes(permissaoNecessaria)) {
                mostrar = true;
            }

            // Aplica a visibilidade e conta
            if (mostrar) {
                item.style.display = 'block';
                linksVisiveis++; // Aumenta a contagem
                // Guarda o link desse item (o href do <a>)
                ultimoLinkEncontrado = item.querySelector('a').getAttribute('href');
            } else {
                item.style.display = 'none';
            }
        });

        // --- O PULO DO GATO ---
        // Se só tiver exatamente 1 link visível...
        if (linksVisiveis === 1) {
            // ...redireciona direto para ele!
            window.location.href = ultimoLinkEncontrado;
        }
    });
</script>
</body>
</html>